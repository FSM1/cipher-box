ok coderabbit has come back with a bunch of comments, but many of them relate to the CI failure re. test coverage, so can be safely ignored. There are some other comments that look pretty valid and should be addressed. you know what to do.