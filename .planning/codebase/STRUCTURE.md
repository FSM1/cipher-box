# Codebase Structure

**Analysis Date:** 2026-01-20

## Directory Layout

```
cipher-box/
├── .claude/                    # Claude AI configuration and commands
│   ├── agents/                 # Agent definitions
│   ├── commands/               # Custom slash commands
│   │   └── gsd/                # Get-Shit-Done workflow commands
│   ├── get-shit-done/          # GSD framework assets
│   │   ├── references/         # Reference documentation
│   │   ├── templates/          # Document templates
│   │   └── workflows/          # Workflow definitions
│   ├── hooks/                  # Git/event hooks
│   └── CLAUDE.md               # Project instructions for Claude
├── .github/                    # GitHub configuration
├── .planning/                  # GSD planning artifacts
│   └── codebase/               # Codebase analysis documents (this file)
├── .vscode/                    # VS Code settings
├── 00-Preliminary-R&D/         # Specification and proof-of-concept
│   ├── Documentation/          # Finalized specification documents
│   │   ├── API_SPECIFICATION.md
│   │   ├── CLIENT_SPECIFICATION.md
│   │   ├── DATA_FLOWS.md
│   │   ├── IMPLEMENTATION_ROADMAP.md
│   │   ├── PRD.md
│   │   └── TECHNICAL_ARCHITECTURE.md
│   └── poc/                    # Console proof-of-concept harness
│       ├── dist/               # Compiled TypeScript output
│       ├── node_modules/       # Dependencies
│       ├── scripts/            # Utility scripts
│       ├── src/                # Source code
│       │   └── index.ts        # Main PoC entry point
│       ├── state/              # Runtime state directory
│       ├── package.json        # PoC dependencies
│       └── tsconfig.json       # TypeScript config
├── 00_START_HERE.md            # Quick-start overview document
├── README.md                   # Project overview and architecture
├── LICENSE                     # Apache 2.0 license
├── .gitignore                  # Git ignore patterns
└── cipherbox logo.png          # Project logo asset
```

## Directory Purposes

**`.claude/`:**
- Purpose: Claude AI project configuration and GSD workflow framework
- Contains: Agent definitions, custom commands, templates, workflow configs
- Key files: `CLAUDE.md` (project rules), `commands/gsd/` (workflow commands)

**`.planning/codebase/`:**
- Purpose: Codebase analysis documents generated by GSD mapping
- Contains: Architecture, structure, conventions, testing, concerns analysis
- Key files: `ARCHITECTURE.md`, `STRUCTURE.md` (this file)

**`00-Preliminary-R&D/Documentation/`:**
- Purpose: Finalized v1.11.1 specification documents (DO NOT MODIFY)
- Contains: Complete system design across 6 documents
- Key files: `TECHNICAL_ARCHITECTURE.md` (encryption, security), `API_SPECIFICATION.md` (15 endpoints)

**`00-Preliminary-R&D/poc/`:**
- Purpose: Console-based proof-of-concept validating IPFS/IPNS flows
- Contains: Single TypeScript file demonstrating encryption and file operations
- Key files: `src/index.ts` (703 lines, complete validation harness)

## Key File Locations

**Entry Points:**
- `00-Preliminary-R&D/poc/src/index.ts`: PoC console harness main entry

**Configuration:**
- `00-Preliminary-R&D/poc/package.json`: PoC dependencies and scripts
- `00-Preliminary-R&D/poc/tsconfig.json`: TypeScript compiler config
- `.claude/CLAUDE.md`: Project rules for Claude AI

**Core Logic:**
- `00-Preliminary-R&D/poc/src/index.ts`: All PoC encryption, IPFS, and folder operations

**Specifications:**
- `00-Preliminary-R&D/Documentation/TECHNICAL_ARCHITECTURE.md`: Encryption, key hierarchy, TEE
- `00-Preliminary-R&D/Documentation/API_SPECIFICATION.md`: Backend endpoints, database schema
- `00-Preliminary-R&D/Documentation/CLIENT_SPECIFICATION.md`: Web UI, desktop app specs
- `00-Preliminary-R&D/Documentation/DATA_FLOWS.md`: Sequence diagrams, test vectors
- `00-Preliminary-R&D/Documentation/PRD.md`: Product requirements, user journeys
- `00-Preliminary-R&D/Documentation/IMPLEMENTATION_ROADMAP.md`: 12-week development plan

**Documentation:**
- `00_START_HERE.md`: Quick overview with key decisions
- `README.md`: Full project overview and architecture summary

## Naming Conventions

**Files:**
- Specification docs: `UPPERCASE_SNAKE.md` (e.g., `TECHNICAL_ARCHITECTURE.md`)
- Source files: `lowercase.ts` (e.g., `index.ts`)
- Config files: `lowercase.json` (e.g., `package.json`, `tsconfig.json`)

**Directories:**
- Numbered prefix for ordering: `00-Preliminary-R&D/` (stage indicator)
- Lowercase with hyphens for standard dirs: `.planning/`, `.claude/`
- PascalCase for specification subdir: `Documentation/`

**Code (from PoC and spec):**
- Types: `PascalCase` (e.g., `FolderEntry`, `FileEntry`, `HarnessContext`)
- Functions: `camelCase` (e.g., `aesGcmEncrypt`, `publishFolderMetadata`)
- Constants: `UPPER_SNAKE_CASE` (e.g., `TAG_SIZE`, `IV_SIZE`)
- API fields: `camelCase` (e.g., `rootFolderKey`, `ipnsName`)
- Database columns: `snake_case` (e.g., `encrypted_ipns_key`, `key_epoch`)

## Where to Add New Code

**New Backend Feature:**
- Primary code: Create `backend/` directory at root
- Spec reference: `00-Preliminary-R&D/Documentation/API_SPECIFICATION.md`
- Pattern: NestJS modules with controllers, services, entities

**New Frontend Feature:**
- Primary code: Create `frontend/` directory at root
- Spec reference: `00-Preliminary-R&D/Documentation/CLIENT_SPECIFICATION.md`
- Pattern: React 18 with TypeScript, Web Crypto API

**New Desktop Feature:**
- Primary code: Create `desktop/` directory at root
- Spec reference: `00-Preliminary-R&D/Documentation/CLIENT_SPECIFICATION.md` (Section 2)
- Pattern: Tauri or Electron with FUSE integration

**Extending PoC:**
- Implementation: `00-Preliminary-R&D/poc/src/index.ts`
- Note: PoC is validation-only, not production code

**New Utility/Helper:**
- Shared helpers: Create `shared/` or `common/` at root (when implementing)
- PoC utilities: Add to `00-Preliminary-R&D/poc/src/` (if extending PoC)

**New Specification:**
- Location: `00-Preliminary-R&D/Documentation/`
- Warning: Existing specs are finalized (v1.11.1) - create new docs for changes

**Planning/Analysis Documents:**
- Location: `.planning/` (e.g., `.planning/codebase/`, `.planning/phases/`)

## Special Directories

**`00-Preliminary-R&D/Documentation/`:**
- Purpose: Finalized specification documents
- Generated: No (manually authored)
- Committed: Yes
- Note: DO NOT MODIFY - create new implementation docs elsewhere

**`00-Preliminary-R&D/poc/dist/`:**
- Purpose: Compiled JavaScript output from TypeScript
- Generated: Yes (`npm run build`)
- Committed: Varies (typically no)

**`00-Preliminary-R&D/poc/node_modules/`:**
- Purpose: npm dependencies
- Generated: Yes (`npm install`)
- Committed: No (in .gitignore)

**`00-Preliminary-R&D/poc/state/`:**
- Purpose: Runtime state for PoC harness
- Generated: Yes (during PoC execution)
- Committed: No

**`.planning/codebase/`:**
- Purpose: GSD codebase mapping outputs
- Generated: Yes (by GSD workflow)
- Committed: Yes

## Implementation Status

| Component | Spec Location | Implementation | Status |
|-----------|---------------|----------------|--------|
| Backend API | `API_SPECIFICATION.md` | Not created | Planned |
| Web Frontend | `CLIENT_SPECIFICATION.md` | Not created | Planned |
| Desktop App | `CLIENT_SPECIFICATION.md` | Not created | Planned |
| TEE Integration | `TECHNICAL_ARCHITECTURE.md` | Not created | Planned |
| Database | `API_SPECIFICATION.md` | Not created | Planned |
| PoC Harness | N/A | `poc/src/index.ts` | Complete |

---

*Structure analysis: 2026-01-20*
