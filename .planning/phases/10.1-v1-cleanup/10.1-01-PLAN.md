---
phase: 10.1-v1-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/file-browser/FolderTree.tsx
  - apps/web/src/components/file-browser/FolderTreeNode.tsx
  - apps/web/src/components/file-browser/index.ts
  - apps/web/src/components/ApiStatusIndicator.tsx
  - apps/web/src/routes/Login.tsx
  - apps/web/src/routes/Dashboard.tsx
  - apps/web/src/stores/quota.store.ts
  - apps/api/src/ipfs/ipfs.controller.ts
  - apps/api/src/ipfs/dto/add.dto.ts
  - apps/api/src/ipfs/dto/index.ts
  - apps/api/test/ipfs.e2e-spec.ts
  - tests/e2e/page-objects/file-browser/folder-tree.page.ts
  - tests/e2e/page-objects/file-browser/index.ts
autonomous: true

must_haves:
  truths:
    - 'Deprecated FolderTree, FolderTreeNode, ApiStatusIndicator components no longer exist in codebase'
    - 'Deprecated Dashboard route component no longer exists'
    - 'Login page still shows API status using the new StatusIndicator component'
    - 'No dead /ipfs/add endpoint in the API'
    - 'No unused addUsage method in quota store'
    - 'TypeScript compiles without errors after removals'
    - 'Generated API client regenerated without /ipfs/add references'
  artifacts:
    - path: 'apps/web/src/components/file-browser/index.ts'
      provides: 'Barrel export without FolderTree/FolderTreeNode'
      contains: 'FileBrowser'
    - path: 'apps/web/src/routes/Login.tsx'
      provides: 'Login page using StatusIndicator'
      contains: 'StatusIndicator'
    - path: 'apps/api/src/ipfs/ipfs.controller.ts'
      provides: 'IPFS controller with only upload, unpin, and get endpoints'
  key_links:
    - from: 'apps/web/src/routes/Login.tsx'
      to: 'apps/web/src/components/layout/StatusIndicator.tsx'
      via: 'import'
      pattern: 'import.*StatusIndicator.*layout'
---

<!-- markdownlint-disable MD033 -->

<objective>
Remove deprecated components, unused code, and dead API endpoints from the codebase.

Purpose: Clean up tech debt accumulated across phases 6.3 and 7.1 where components were deprecated but not removed, and an API endpoint was superseded but left in place.

Output: Leaner codebase with no deprecated/dead code, regenerated API client.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove deprecated frontend components and dead code</name>
  <files>
    apps/web/src/components/file-browser/FolderTree.tsx
    apps/web/src/components/file-browser/FolderTreeNode.tsx
    apps/web/src/components/file-browser/index.ts
    apps/web/src/components/ApiStatusIndicator.tsx
    apps/web/src/routes/Dashboard.tsx
    apps/web/src/routes/Login.tsx
    apps/web/src/stores/quota.store.ts
    tests/e2e/page-objects/file-browser/folder-tree.page.ts
    tests/e2e/page-objects/file-browser/index.ts
  </files>
  <action>
DELETE these files entirely (they are deprecated since Phase 6.3):

- `apps/web/src/components/file-browser/FolderTree.tsx`
- `apps/web/src/components/file-browser/FolderTreeNode.tsx`
- `apps/web/src/components/ApiStatusIndicator.tsx`
- `apps/web/src/routes/Dashboard.tsx`
- `tests/e2e/page-objects/file-browser/folder-tree.page.ts`

EDIT `apps/web/src/components/file-browser/index.ts` — remove the two deprecated export lines at bottom:

```ts
// @deprecated - kept for backwards compatibility, will be removed in future cleanup
export { FolderTree } from './FolderTree';
export { FolderTreeNode } from './FolderTreeNode';
```

EDIT `tests/e2e/page-objects/file-browser/index.ts` — remove the deprecated export and its comment block:

```ts
/**
 * @deprecated FolderTree was removed from FileBrowser in Phase 6.3.
 * Navigation is now inline (double-click folders, [..] to go up).
 */
export { FolderTreePage } from './folder-tree.page';
```

EDIT `apps/web/src/routes/Login.tsx`:

- Replace `import { ApiStatusIndicator } from '../components/ApiStatusIndicator';` with `import { StatusIndicator } from '../components/layout';`
- Replace `<ApiStatusIndicator />` with `<StatusIndicator />`

EDIT `apps/web/src/stores/quota.store.ts`:

- Remove `addUsage` from the `QuotaState` type (line 12)
- Remove the `addUsage` implementation (lines 39-42)
- This method was replaced by server-authoritative `fetchQuota` in Phase 7.1 and has zero callers.

Verify no remaining imports of deleted components:

- Search for `FolderTree`, `FolderTreeNode`, `ApiStatusIndicator`, `Dashboard` imports across `apps/web/src` and `tests/e2e`
- The comment reference in `apps/web/src/hooks/useFolderNavigation.ts` line 97 is a JSDoc example; update it to remove the FolderTree reference or remove the example entirely.
- The "Back to Dashboard" text in `apps/web/src/routes/Settings.tsx` is a nav link to `/dashboard` which redirects to `/files`. Change the text from "Back to Dashboard" to "Back to Files" for clarity since Dashboard no longer exists.
  </action>
  <verify>
  Run `cd /Users/michael/Code/cipher-box && pnpm --filter web build` to confirm TypeScript compiles without errors after removals.
  Run `grep -r "FolderTree\|FolderTreeNode\|ApiStatusIndicator" apps/web/src/ --include="*.ts" --include="*.tsx" -l` — should return 0 files (except the Breadcrumbs.tsx onNavigateUp deprecated prop comment which is acceptable).
  </verify>
  <done>
  FolderTree.tsx, FolderTreeNode.tsx, ApiStatusIndicator.tsx, Dashboard.tsx, and folder-tree.page.ts deleted. Barrel exports cleaned. Login.tsx uses StatusIndicator. addUsage removed from quota store. Web app builds clean.
  </done>
  </task>

<task type="auto">
  <name>Task 2: Remove /ipfs/add endpoint and regenerate API client</name>
  <files>
    apps/api/src/ipfs/ipfs.controller.ts
    apps/api/src/ipfs/dto/add.dto.ts
    apps/api/src/ipfs/dto/index.ts
    apps/api/test/ipfs.e2e-spec.ts
    apps/web/src/api/ipfs/ipfs.ts (regenerated)
    apps/web/src/api/models/ (regenerated)
  </files>
  <action>
EDIT `apps/api/src/ipfs/ipfs.controller.ts`:

- Remove the entire `@Post('add')` handler method (lines 49-96), including all its Swagger decorators, the `@UseInterceptors`, `@UploadedFile`, and the `async add()` method body.
- Remove `AddResponseDto` from the import on line 30 (keep UploadResponseDto, UnpinDto, UnpinResponseDto).
- Verify no other code in the controller references `AddResponseDto`.

DELETE `apps/api/src/ipfs/dto/add.dto.ts` (the DTO is only used by the removed endpoint).

EDIT `apps/api/src/ipfs/dto/index.ts` — remove `export { AddResponseDto } from './add.dto';`

EDIT `apps/api/test/ipfs.e2e-spec.ts` — remove the entire `describe('POST /ipfs/add', ...)` block (starts around line 96). Keep all other test blocks (POST /ipfs/upload, POST /ipfs/unpin, GET /ipfs/:cid).

Regenerate the API client by running `pnpm api:generate` from the monorepo root. This will regenerate `apps/web/src/api/ipfs/ipfs.ts` and `apps/web/src/api/models/` without the `/ipfs/add` endpoint types and hooks.

Verify the web app still builds after regeneration with `pnpm --filter web build`.
</action>
<verify>
Run `cd /Users/michael/Code/cipher-box && pnpm --filter api build` — API compiles clean.
Run `cd /Users/michael/Code/cipher-box && pnpm api:generate` — regeneration succeeds.
Run `cd /Users/michael/Code/cipher-box && pnpm --filter web build` — web app compiles clean.
Run `grep -r "ipfs/add\|ipfsControllerAdd\|AddResponseDto" apps/web/src/api/ apps/api/src/ --include="*.ts" -l` — should return 0 files.
</verify>
<done>
/ipfs/add endpoint removed from controller. AddResponseDto deleted. E2E tests for /ipfs/add removed. API client regenerated without /ipfs/add. Both API and web app build clean.
</done>
</task>

</tasks>

<verification>

1. `pnpm --filter api build` passes (no TypeScript errors in API)
2. `pnpm --filter web build` passes (no TypeScript errors in web)
3. No grep hits for deleted component names in source files
4. `pnpm --filter api test` passes (unit tests still green after removing /ipfs/add test block)
5. No `@deprecated` markers remain for FolderTree, FolderTreeNode, ApiStatusIndicator, or Dashboard

</verification>

<success_criteria>

- Zero deprecated components remain (FolderTree, FolderTreeNode, ApiStatusIndicator, Dashboard)
- Zero dead endpoints remain (/ipfs/add removed)
- Zero unused store methods remain (addUsage removed)
- Both apps build clean with `pnpm build`
- API unit tests pass
- Generated API client reflects current endpoints only

</success_criteria>

<output>
After completion, create `.planning/phases/10.1-v1-cleanup/10.1-01-SUMMARY.md`
</output>
