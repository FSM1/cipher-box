---
phase: 06.2-restyle-app-pencil-design
plan: 06
type: execute
wave: 4
depends_on: ["06.2-05"]
files_modified:
  - e2e/tests/file-browser.spec.ts
  - e2e/tests/folder-operations.spec.ts
  - e2e/page-objects/FileBrowserPage.ts
autonomous: false

must_haves:
  truths:
    - "All E2E tests pass with new terminal styling"
    - "Test selectors updated to match new text content"
    - "Visual appearance matches Pencil design specification"
    - "Responsive design works on mobile viewport"
  artifacts:
    - path: "e2e/tests/file-browser.spec.ts"
      provides: "Updated E2E tests for restyled UI"
    - path: "e2e/page-objects/FileBrowserPage.ts"
      provides: "Updated page object selectors"
  key_links:
    - from: "e2e/page-objects/FileBrowserPage.ts"
      to: "apps/web/src/components/file-browser/*.tsx"
      via: "CSS selectors and text content"
      pattern: "getByRole|getByText|locator"
---

<objective>
Update E2E tests for new styling and verify the complete restyle works correctly.

Purpose: The UI changes may have affected selectors used in E2E tests. This plan ensures tests are updated to work with the new terminal styling, then verifies the complete restyle through automated and manual testing.

Output: All E2E tests passing, visual verification complete.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06.2-restyle-app-with-pencil-design/06.2-CONTEXT.md
@.planning/phases/06.2-restyle-app-with-pencil-design/06.2-05-SUMMARY.md
@e2e/page-objects/FileBrowserPage.ts
@e2e/tests/file-browser.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update E2E page objects and test selectors</name>
  <files>e2e/page-objects/FileBrowserPage.ts, e2e/tests/file-browser.spec.ts, e2e/tests/folder-operations.spec.ts</files>
  <action>
Read the existing page objects and test files to identify selectors that may need updating based on the UI changes:

1. Button text changes:
   - Upload button: now shows `--upload` instead of previous text
   - New folder button: now shows `--new-dir` instead of previous text
   - Refresh button: now shows `--refresh` instead of previous text
   - Login button: now shows `[CONNECT]` instead of previous text

2. Icon changes:
   - Files now show `[FILE]` text instead of emoji
   - Folders now show `[DIR]` text instead of emoji

3. Header changes:
   - Dashboard title now shows `> CIPHERBOX`

Update any selectors in page objects that use:
- `getByRole('button', { name: '...' })` - update button names
- `getByText('...')` - update text content
- Emoji characters in selectors - replace with new text

Common patterns to update:

```typescript
// Before (if using button text)
this.uploadButton = page.getByRole('button', { name: /upload/i });

// After
this.uploadButton = page.getByRole('button', { name: '--upload' });

// Or use class selector (more stable)
this.uploadButton = page.locator('.toolbar-button--primary');
```

For file/folder detection:
```typescript
// Before (if checking for emoji)
const isFolder = await item.locator('text=folder-emoji').isVisible();

// After
const isFolder = await item.locator('text=[DIR]').isVisible();
```

Prefer CSS class selectors over text content where possible for stability:
- `.toolbar-button--primary` for upload
- `.toolbar-button--secondary` for new-dir and refresh
- `.file-list-item` for file items
- `.folder-tree-item` for folder tree items
  </action>
  <verify>Run `pnpm --filter e2e test` and check all tests pass</verify>
  <done>E2E test selectors updated to match new terminal styling</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete terminal/hacker aesthetic restyle of CipherBox web app including:
- JetBrains Mono font throughout
- Green-on-black color scheme
- [DIR]/[FILE] text prefixes
- --upload, --new-dir, --refresh button labels
- Matrix background animation on login
- Terminal-styled modals, dialogs, and context menus
- Responsive mobile design with terminal aesthetic</what-built>
  <how-to-verify>
1. Start the app: `pnpm dev`

2. **Login Page** (http://localhost:5173):
   - [ ] Black background with subtle matrix animation
   - [ ] `> CIPHERBOX` title with monospace font
   - [ ] `[CONNECT]` button (green, sharp corners)
   - [ ] API status indicator in bottom-right

3. **File Browser** (after login):
   - [ ] Header shows `> CIPHERBOX` branding
   - [ ] Sidebar has green right border
   - [ ] Folder tree shows `[DIR]` prefixes
   - [ ] Toolbar buttons: `--upload`, `--new-dir`, `--refresh`
   - [ ] File list has green border
   - [ ] Column headers: NAME, SIZE, TYPE, MODIFIED
   - [ ] Files show `[FILE]` prefix, folders show `[DIR]`
   - [ ] Hover states show green highlight

4. **Context Menu** (right-click a file):
   - [ ] Green border, black background
   - [ ] Monospace font
   - [ ] Delete option in red

5. **Upload Dialog** (click --upload):
   - [ ] Terminal-styled modal
   - [ ] Green progress bar
   - [ ] Sharp corners throughout

6. **Rename Dialog** (right-click > Rename):
   - [ ] Terminal-styled input field
   - [ ] Green focus glow on input
   - [ ] Proper button styling

7. **Mobile** (resize to 390px width or use DevTools):
   - [ ] Hamburger menu appears
   - [ ] Sidebar slides in with green border
   - [ ] File list shows 2 columns (NAME, SIZE)
   - [ ] Touch interactions work

8. **Run E2E Tests**:
   ```bash
   pnpm --filter e2e test
   ```
   - [ ] All tests pass
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues that need fixing</resume-signal>
</task>

</tasks>

<verification>
1. E2E test suite passes: `pnpm --filter e2e test`
2. Visual inspection matches Pencil design
3. No console errors in browser
4. Responsive design works at 390px and 1440px widths
5. Matrix animation is subtle and performant
6. All interactive elements work (upload, download, rename, delete, navigate)
</verification>

<success_criteria>
- All E2E tests pass with updated selectors
- Visual appearance matches Pencil design specification
- Login shows matrix animation, [CONNECT] button, > CIPHERBOX branding
- File browser shows terminal aesthetic throughout
- Mobile responsive design maintains terminal theme
- No regressions in functionality
</success_criteria>

<output>
After completion, create `.planning/phases/06.2-restyle-app-with-pencil-design/06.2-06-SUMMARY.md`
</output>
