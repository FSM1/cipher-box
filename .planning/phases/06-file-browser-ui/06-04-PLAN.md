---
phase: 06-file-browser-ui
plan: 04
type: execute
wave: 3
depends_on: ["06-03"]
files_modified:
  - apps/web/src/components/file-browser/Breadcrumbs.tsx
  - apps/web/src/components/file-browser/FileBrowser.tsx
  - apps/web/src/components/file-browser/FolderTree.tsx
  - apps/web/src/hooks/useFolderNavigation.ts
  - apps/web/src/styles/file-browser.css
  - apps/web/src/styles/breadcrumbs.css
  - apps/web/src/styles/responsive.css
  - apps/web/src/App.css
  - apps/web/src/components/file-browser/index.ts
autonomous: false

must_haves:
  truths:
    - "User can see and click breadcrumbs to navigate up folder hierarchy"
    - "UI is responsive and usable on mobile web"
    - "Sidebar collapses to overlay on mobile"
    - "User can toggle sidebar visibility on mobile"
    - "Touch gestures work for basic navigation"
  artifacts:
    - path: "apps/web/src/components/file-browser/Breadcrumbs.tsx"
      provides: "Breadcrumb navigation component"
      exports: ["Breadcrumbs"]
    - path: "apps/web/src/styles/responsive.css"
      provides: "Mobile responsive styles"
      contains: "@media"
  key_links:
    - from: "apps/web/src/components/file-browser/Breadcrumbs.tsx"
      to: "useFolderNavigation"
      via: "breadcrumbs array and navigation"
      pattern: "breadcrumbs"
    - from: "apps/web/src/components/file-browser/FileBrowser.tsx"
      to: "responsive CSS"
      via: "mobile sidebar toggle"
      pattern: "sidebarOpen|mobile"
---

<objective>
Implement breadcrumb navigation and responsive mobile design.

Purpose: Complete the file browser experience with navigation breadcrumbs (WEB-06) and mobile responsiveness (WEB-05). Per CONTEXT.md: Breadcrumbs use simple back navigation with current folder name; sidebar auto-collapses on mobile as overlay.

Output: Breadcrumb navigation, responsive layout with mobile sidebar overlay, visual verification checkpoint.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-file-browser-ui/06-CONTEXT.md
@.planning/phases/06-file-browser-ui/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Breadcrumbs component</name>
  <files>
    apps/web/src/components/file-browser/Breadcrumbs.tsx
    apps/web/src/hooks/useFolderNavigation.ts
    apps/web/src/styles/breadcrumbs.css
  </files>
  <action>
Create Breadcrumbs component:
- Props: breadcrumbs array (from useFolderNavigation), onNavigate(folderId)
- Per CONTEXT.md: "simple back navigation with current folder name and back arrow"
- Structure:
  - Back button (left arrow) - navigates to parent folder, hidden at root
  - Current folder name display
  - Per CONTEXT.md: "structure should allow dropdown-per-segment in future"
- Render:
  - If at root: just show "My Vault" (no back arrow)
  - Otherwise: back arrow + current folder name
- Back arrow onClick: navigate to parent (second-to-last breadcrumb)
- Accessible: aria-label on back button

Update useFolderNavigation hook:
- Ensure breadcrumbs array is properly built on navigation
- Breadcrumbs format: [{ id: 'root', name: 'My Vault' }, { id: 'folder-1', name: 'Documents' }, ...]
- Add goBack() function that navigates to parent folder

Create breadcrumbs.css:
- .breadcrumbs - flex row, align-items center, gap
- .breadcrumbs-back - back arrow button, hover state
- .breadcrumbs-current - current folder name, font-weight bold
- Mobile: breadcrumbs stay visible above file list
  </action>
  <verify>
TypeScript compiles: `pnpm exec tsc --noEmit`
Lint passes: `pnpm lint`
  </verify>
  <done>
Breadcrumbs show current folder name.
Back arrow navigates to parent folder.
Back arrow hidden at root level.
Breadcrumbs accessible with proper aria labels.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement responsive mobile layout</name>
  <files>
    apps/web/src/components/file-browser/FileBrowser.tsx
    apps/web/src/components/file-browser/FolderTree.tsx
    apps/web/src/styles/file-browser.css
    apps/web/src/styles/responsive.css
    apps/web/src/App.css
  </files>
  <action>
Update FileBrowser.tsx:
- Add state: sidebarOpen (boolean), default false on mobile, true on desktop
- Add toggle button (hamburger icon) in header for mobile
- Pass sidebarOpen to FolderTree for conditional rendering
- On folder navigation, close sidebar on mobile (better UX)
- Detect mobile via CSS media query or window.matchMedia for initial state

Create responsive.css with media queries:
- Breakpoint: 768px (tablet/desktop) and below (mobile)
- Desktop (>= 768px):
  - Sidebar always visible, 250px width
  - File list takes remaining space
  - No hamburger toggle
- Mobile (< 768px):
  - Sidebar hidden by default
  - Hamburger button visible in header
  - When open: sidebar slides in as overlay (position fixed, z-index high)
  - Backdrop behind sidebar to close on tap outside
  - File list full width
  - Context menu: consider touch-friendly sizing

Update FolderTree.tsx:
- Accept isOpen prop (always true on desktop)
- Add close button (X) for mobile overlay mode
- Conditional class for overlay mode

Update file-browser.css:
- .file-browser-sidebar-open - visible state
- .file-browser-sidebar-closed - hidden state
- .file-browser-toggle - hamburger button styling
- .file-browser-overlay - mobile sidebar backdrop

Update App.css if needed:
- Ensure dashboard layout works responsively
- Import responsive.css

Mobile touch considerations:
- Context menu: use long-press to trigger (add touchstart/touchend handlers)
- Per CONTEXT.md: "mobile gesture handling beyond basic touch" is Claude's discretion
- For v1: long-press (500ms) triggers context menu
  </action>
  <verify>
TypeScript compiles: `pnpm exec tsc --noEmit`
Lint passes: `pnpm lint`
Resize browser to mobile width - sidebar hidden
Click hamburger - sidebar appears as overlay
Click outside sidebar - sidebar closes
  </verify>
  <done>
Desktop: sidebar always visible.
Mobile: sidebar hidden, hamburger toggle shows it.
Sidebar appears as overlay on mobile.
Tap outside closes sidebar on mobile.
File list is full width on mobile.
Long-press triggers context menu on touch devices.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete file browser UI with:
- Login page with Web3Auth modal
- File browser with folder tree sidebar
- Drag-drop file upload with progress modal
- Context menu for rename, delete, download
- Drag-drop move to folder tree
- Breadcrumb navigation
- Responsive mobile layout with collapsible sidebar
  </what-built>
  <how-to-verify>
1. Start dev server: `cd apps/web && pnpm dev`
2. Open http://localhost:5173 in browser

**Login (WEB-01):**
- Verify login page shows "Sign In" button
- Click Sign In - Web3Auth modal should open
- (If testing locally without Web3Auth, verify modal attempts to open)

**File Browser (WEB-02):**
- After login, verify file browser layout with sidebar and file list
- Sidebar shows folder tree with "My Vault" root
- File list shows files with name, size, date columns
- Click folder in sidebar - navigates to that folder

**Upload (WEB-03):**
- Drag a file onto the drop zone
- Verify upload modal appears with progress
- Verify file appears in list after upload
- Try click-to-upload as well

**Context Menu (WEB-04):**
- Right-click a file - context menu with Download, Rename, Delete
- Right-click a folder - context menu with Rename, Delete
- Test Rename - dialog opens, rename works
- Test Delete - confirmation shows, item removed

**Drag-Drop Move:**
- Drag a file from list to a folder in sidebar
- Verify file moves to target folder

**Breadcrumbs (WEB-06):**
- Navigate into a subfolder
- Verify breadcrumb shows folder name with back arrow
- Click back arrow - returns to parent folder

**Responsive (WEB-05):**
- Resize browser to mobile width (< 768px)
- Sidebar should be hidden, hamburger button visible
- Click hamburger - sidebar slides in as overlay
- Tap outside sidebar - it closes
- Long-press on file - context menu appears (touch device)
  </how-to-verify>
  <resume-signal>Type "approved" if all verification passes, or describe issues found</resume-signal>
</task>

</tasks>

<verification>
1. TypeScript compiles: `pnpm exec tsc --noEmit`
2. Lint passes: `pnpm lint`
3. Human verification of all WEB-* requirements
</verification>

<success_criteria>
- WEB-01: Login page with Web3Auth modal (verified working)
- WEB-02: File browser with folder tree sidebar (verified working)
- WEB-03: Drag-drop file upload (verified working)
- WEB-04: Context menu with actions (verified working)
- WEB-05: Responsive mobile design (verified working)
- WEB-06: Breadcrumb navigation (verified working)
</success_criteria>

<output>
After completion, create `.planning/phases/06-file-browser-ui/06-04-SUMMARY.md`
</output>
