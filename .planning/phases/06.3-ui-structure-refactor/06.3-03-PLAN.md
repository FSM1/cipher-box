---
phase: 06.3-ui-structure-refactor
plan: 03
type: execute
wave: 2
depends_on: ['06.3-01']
files_modified:
  - apps/web/src/components/file-browser/FileList.tsx
  - apps/web/src/components/file-browser/FileListItem.tsx
  - apps/web/src/components/file-browser/ParentDirRow.tsx
  - apps/web/src/components/file-browser/Breadcrumbs.tsx
  - apps/web/src/components/file-browser/EmptyState.tsx
  - apps/web/src/styles/file-browser.css
autonomous: true

must_haves:
  truths:
    - 'File list shows [..] PARENT_DIR row in non-root folders'
    - 'Column headers display as [NAME] [SIZE] [MODIFIED]'
    - 'TYPE column is removed from file list'
    - 'Clicking [..] row navigates to parent folder'
    - 'Empty state shows terminal-style ASCII art'
    - 'Breadcrumbs show path format ~/root/path'
  artifacts:
    - path: 'apps/web/src/components/file-browser/ParentDirRow.tsx'
      provides: 'Parent directory navigation row'
      exports: ['ParentDirRow']
    - path: 'apps/web/src/components/file-browser/FileList.tsx'
      provides: 'Updated file list with 3 columns'
      exports: ['FileList']
    - path: 'apps/web/src/components/file-browser/Breadcrumbs.tsx'
      provides: 'Path-format breadcrumbs'
      exports: ['Breadcrumbs']
  key_links:
    - from: 'apps/web/src/components/file-browser/FileList.tsx'
      to: 'ParentDirRow.tsx'
      via: 'component import'
      pattern: 'import.*ParentDirRow'
    - from: 'apps/web/src/components/file-browser/ParentDirRow.tsx'
      to: 'navigation callback'
      via: 'onClick prop'
      pattern: 'onClick.*navigate'
---

<objective>
Update file list components with new column structure, parent directory navigation, and empty state.

Purpose: Implement the in-place folder navigation pattern with [..] PARENT_DIR row, remove the TYPE column, update column headers to bracket format, and add terminal-style ASCII art to empty state.

Output: Updated FileList with 3 columns (Name, Size, Modified), new ParentDirRow component, updated Breadcrumbs with path format, and ASCII art empty state.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06.3-ui-structure-refactor/06.3-CONTEXT.md
@.planning/phases/06.3-ui-structure-refactor/06.3-RESEARCH.md
@apps/web/src/components/file-browser/FileList.tsx
@apps/web/src/components/file-browser/FileListItem.tsx
@apps/web/src/components/file-browser/Breadcrumbs.tsx
@apps/web/src/components/file-browser/EmptyState.tsx
@apps/web/src/styles/file-browser.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ParentDirRow and Update FileList Structure</name>
  <files>
    apps/web/src/components/file-browser/ParentDirRow.tsx
    apps/web/src/components/file-browser/FileList.tsx
    apps/web/src/styles/file-browser.css
  </files>
  <action>
Create parent directory row component and update file list structure.

**ParentDirRow.tsx:**

```tsx
type ParentDirRowProps = {
  onClick: () => void;
};

export function ParentDirRow({ onClick }: ParentDirRowProps) {
  return (
    <div
      className="file-list-item file-list-item--parent"
      onClick={onClick}
      role="row"
      tabIndex={0}
      onKeyDown={(e) => e.key === 'Enter' && onClick()}
      data-testid="parent-dir-row"
    >
      <div className="file-list-item-row-top">
        <span className="file-list-item-icon">[..]</span>
        <span className="file-list-item-name">PARENT_DIR</span>
      </div>
      <div className="file-list-item-size">--</div>
      <div className="file-list-item-date">--</div>
    </div>
  );
}
```

**FileList.tsx changes:**

1. Add new props for parent navigation:

```tsx
type FileListProps = {
  // ... existing props
  parentId: string; // Already exists
  showParentRow?: boolean; // New: whether to show [..] row
  onNavigateUp?: () => void; // New: callback for parent navigation
};
```

2. Update column headers to bracket format:

```tsx
<div className="file-list-header" role="row">
  <div className="file-list-header-name" role="columnheader">
    [NAME]
  </div>
  <div className="file-list-header-size" role="columnheader">
    [SIZE]
  </div>
  <div className="file-list-header-date" role="columnheader">
    [MODIFIED]
  </div>
</div>
```

3. Remove TYPE column header (delete file-list-header-type div).

4. Add ParentDirRow as first item when showParentRow is true:

```tsx
<div className="file-list-body" role="rowgroup">
  {showParentRow && onNavigateUp && (
    <ParentDirRow onClick={onNavigateUp} />
  )}
  {sortedItems.map((item) => (
    <FileListItem ... />
  ))}
</div>
```

**file-browser.css changes:**

1. Update grid columns from 4 to 3:

```css
.file-list-header {
  grid-template-columns: 1fr 120px 180px;
  /* Remove 'type' from grid-template-areas if present */
}

.file-list-item {
  grid-template-columns: 1fr 120px 180px;
  grid-template-areas: 'name size date';
}
```

2. Add parent row styles:

```css
.file-list-item--parent {
  cursor: pointer;
}

.file-list-item--parent:hover {
  background-color: var(--color-green-darker);
}
```

3. Remove .file-list-header-type and .file-list-item-type styles (or comment out).
   </action>
   <verify>
   Run `pnpm --filter web build` - no TypeScript errors.
   Verify FileList grid has 3 columns.
   Verify ParentDirRow exports correctly.
   </verify>
   <done>
   FileList shows 3 columns [NAME] [SIZE] [MODIFIED]. ParentDirRow created and renders as first row when showParentRow is true.
   </done>
   </task>

<task type="auto">
  <name>Task 2: Update FileListItem and Breadcrumbs</name>
  <files>
    apps/web/src/components/file-browser/FileListItem.tsx
    apps/web/src/components/file-browser/Breadcrumbs.tsx
    apps/web/src/styles/breadcrumbs.css
  </files>
  <action>
Update FileListItem to remove TYPE and update Breadcrumbs to path format.

**FileListItem.tsx changes:**

1. Remove TYPE display from the component:
   - Remove the `<div className="file-list-item-type">` element
   - Keep the grid structure but now only 3 columns

2. Update grid-template-areas in inline styles (if any) to match new 3-column layout.

3. Ensure the existing icon display ([DIR] for folders, [FILE] for files) is preserved in the name column.

4. The component should now render:
   - Name column: icon + name
   - Size column: formatted size (folders show "--")
   - Date column: formatted date

**Breadcrumbs.tsx changes:**

1. Change from individual clickable segments to path string format:

```tsx
// Old: [Home] > [Documents] > [Projects]
// New: ~/root/documents/projects
```

2. Update component structure:

```tsx
export function Breadcrumbs({ breadcrumbs, onNavigate, onNavigateUp }: BreadcrumbsProps) {
  // Build path string from breadcrumbs
  const pathString = '~/' + breadcrumbs.map((b) => b.name.toLowerCase()).join('/');

  return (
    <nav className="breadcrumb-path" aria-label="Current location" data-testid="breadcrumbs">
      <span className="breadcrumb-text">{pathString}</span>
    </nav>
  );
}
```

3. Remove the back button from Breadcrumbs (parent navigation is now via [..] row).

4. Keep onNavigate and onNavigateUp props for potential future use but they're not used in display.

**breadcrumbs.css changes:**

1. Simplify styles for path format:

```css
.breadcrumb-path {
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
}

.breadcrumb-text {
  /* No special styling needed - just monospace text */
}
```

2. Remove old separator and clickable segment styles (can comment out or delete).
   </action>
   <verify>
   Run `pnpm --filter web build` - no TypeScript errors.
   Verify FileListItem has no TYPE column.
   Verify Breadcrumbs renders path format ~/path/to/folder.
   </verify>
   <done>
   FileListItem renders without TYPE column. Breadcrumbs display as ~/root/path format without back button.
   </done>
   </task>

<task type="auto">
  <name>Task 3: Update EmptyState with ASCII Art</name>
  <files>
    apps/web/src/components/file-browser/EmptyState.tsx
    apps/web/src/styles/file-browser.css
  </files>
  <action>
Add terminal-style ASCII art to empty state.

**EmptyState.tsx changes:**

1. Add ASCII art illustration. Use a simple terminal/file cabinet design:

```tsx
const asciiArt = `
     _________
    |   ___   |
    |  |   |  |
    |  |___|  |
    |    _    |
    |   | |   |
    |   |_|   |
    |_________|
`;
// Or a simpler folder icon:
const asciiArt = `
   ___________
  /          /|
 /          / |
|__________|  |
|          |  /
|__________|/
`;
```

2. Update component structure:

```tsx
export function EmptyState({ folderId }: EmptyStateProps) {
  return (
    <div className="empty-state" data-testid="empty-state">
      <div className="empty-state-content">
        <pre className="empty-state-ascii" aria-hidden="true">
          {asciiArt}
        </pre>
        <p className="empty-state-text">// EMPTY DIRECTORY</p>
        <p className="empty-state-hint">drag files here or use upload</p>
      </div>
    </div>
  );
}
```

3. The empty state still functions as a drop zone (keep existing drag-drop handlers if present).

**file-browser.css changes:**

1. Add ASCII art styles:

```css
.empty-state-ascii {
  font-family: var(--font-family-mono);
  font-size: var(--font-size-xs);
  line-height: 1.2;
  color: var(--color-text-secondary);
  margin-bottom: var(--spacing-md);
  white-space: pre;
}
```

2. Update empty state text styles to match terminal aesthetic:

```css
.empty-state-text {
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
  margin: 0 0 var(--spacing-xs) 0;
}

.empty-state-hint {
  font-family: var(--font-family-mono);
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  margin: 0;
  text-transform: lowercase;
}
```

  </action>
  <verify>
Run `pnpm --filter web build` - no TypeScript errors.
Verify EmptyState renders ASCII art.
Verify styles preserve terminal aesthetic.
  </verify>
  <done>
EmptyState shows terminal-style ASCII art illustration with "// EMPTY DIRECTORY" message.
  </done>
</task>

</tasks>

<verification>
1. FileList shows 3 columns: [NAME], [SIZE], [MODIFIED]
2. TYPE column completely removed from header and items
3. ParentDirRow appears as first row in non-root folders
4. Clicking [..] row triggers onNavigateUp callback
5. Breadcrumbs display ~/root/path format
6. EmptyState shows ASCII art
7. `pnpm --filter web build` passes
8. Grid layout correct in both header and item rows
</verification>

<success_criteria>

- ParentDirRow.tsx created with correct structure
- FileList.tsx updated to 3 columns and includes ParentDirRow
- FileListItem.tsx updated to remove TYPE column
- Breadcrumbs.tsx shows path format
- EmptyState.tsx shows ASCII art
- CSS updated for 3-column grid
- Build passes with no TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/06.3-ui-structure-refactor/06.3-03-SUMMARY.md`
</output>
