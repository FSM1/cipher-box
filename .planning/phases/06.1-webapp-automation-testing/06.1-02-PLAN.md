---
phase: 06.1-webapp-automation-testing
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - tests/e2e/page-objects/file-browser/file-list.page.ts
  - tests/e2e/page-objects/file-browser/folder-tree.page.ts
  - tests/e2e/page-objects/file-browser/context-menu.page.ts
  - tests/e2e/page-objects/file-browser/upload-zone.page.ts
  - tests/e2e/page-objects/dialogs/confirm-dialog.page.ts
  - tests/e2e/page-objects/dialogs/rename-dialog.page.ts
  - tests/e2e/page-objects/index.ts
autonomous: true

must_haves:
  truths:
    - 'Page objects encapsulate all File Browser UI interactions'
    - 'Context menu actions (rename, delete, download, move) have dedicated methods'
    - 'Dialog interactions (confirm, rename) are reusable across tests'
    - 'Locators use semantic selectors (getByRole, getByText) over CSS'
  artifacts:
    - path: 'tests/e2e/page-objects/file-browser/file-list.page.ts'
      provides: 'FileList interactions'
      exports: ['FileListPage']
    - path: 'tests/e2e/page-objects/file-browser/context-menu.page.ts'
      provides: 'Context menu interactions'
      exports: ['ContextMenuPage']
    - path: 'tests/e2e/page-objects/dialogs/confirm-dialog.page.ts'
      provides: 'Confirmation dialog interactions'
      exports: ['ConfirmDialogPage']
    - path: 'tests/e2e/page-objects/index.ts'
      provides: 'Barrel export for all page objects'
      exports: ['FileListPage', 'FolderTreePage', 'ContextMenuPage']
  key_links:
    - from: 'tests/e2e/page-objects/file-browser/file-list.page.ts'
      to: 'tests/e2e/page-objects/file-browser/context-menu.page.ts'
      via: 'right-click opens context menu'
      pattern: 'rightClick.*ContextMenu'
    - from: 'tests/e2e/page-objects/file-browser/context-menu.page.ts'
      to: 'tests/e2e/page-objects/dialogs'
      via: 'context menu actions open dialogs'
      pattern: 'click.*Dialog'
---

<objective>
Create comprehensive page objects for File Browser UI components.

Purpose: Encapsulate all File Browser interactions in maintainable page objects. These page objects will be used by all file and folder operation tests, ensuring consistent interaction patterns and easy maintenance when UI changes.

Output:

- FileList page object for file/folder item interactions
- FolderTree page object for sidebar folder navigation
- ContextMenu page object for right-click menu actions
- UploadZone page object for drag-drop upload interactions
- Dialog page objects for confirm and rename dialogs
- Barrel exports for clean imports
  </objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06.1-webapp-automation-testing/06.1-CONTEXT.md
@.planning/phases/06.1-webapp-automation-testing/06.1-RESEARCH.md
@apps/web/src/components/file-browser/FileList.tsx
@apps/web/src/components/file-browser/FolderTree.tsx
@apps/web/src/components/file-browser/ContextMenu.tsx
@apps/web/src/components/file-browser/ConfirmDialog.tsx
@apps/web/src/components/file-browser/RenameDialog.tsx
@apps/web/src/components/file-browser/UploadZone.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FileList and FolderTree page objects</name>
  <files>
    tests/e2e/page-objects/file-browser/file-list.page.ts
    tests/e2e/page-objects/file-browser/folder-tree.page.ts
  </files>
  <action>
    First, examine the actual React components to understand their DOM structure:
    - Read FileList.tsx, FileListItem.tsx to see how files are rendered
    - Read FolderTree.tsx, FolderTreeNode.tsx to see folder structure
    - Note any data-testid attributes or aria roles used

    1. Create tests/e2e/page-objects/file-browser/file-list.page.ts:
       - Import Page, Locator from @playwright/test
       - FileListPage class:
         - constructor(page: Page)
         - Locators (use actual selectors from component inspection):
           - fileListContainer(): getByTestId('file-list') or appropriate selector
           - fileItems(): file item locators
           - folderItems(): folder item locators
         - Methods:
           - getFileItem(name: string): Locator - find specific file by name
           - getFolderItem(name: string): Locator - find specific folder by name
           - rightClickItem(name: string): Promise<void> - right-click to open context menu
           - doubleClickFolder(name: string): Promise<void> - navigate into folder
           - selectItem(name: string): Promise<void> - single click to select
           - getItemCount(): Promise<number> - count visible items
           - isItemVisible(name: string): Promise<boolean>
           - waitForItemToAppear(name: string): Promise<void>
           - waitForItemToDisappear(name: string): Promise<void>

    2. Create tests/e2e/page-objects/file-browser/folder-tree.page.ts:
       - FolderTreePage class:
         - constructor(page: Page)
         - Locators:
           - treeContainer(): sidebar folder tree container
           - folderNodes(): all folder nodes
         - Methods:
           - clickFolder(name: string): Promise<void> - navigate to folder
           - expandFolder(name: string): Promise<void> - expand collapsed folder
           - collapseFolder(name: string): Promise<void>
           - isFolderExpanded(name: string): Promise<boolean>
           - isFolderSelected(name: string): Promise<boolean>
           - getVisibleFolderNames(): Promise<string[]>
           - waitForFolderToAppear(name: string): Promise<void>

  </action>
  <verify>
    cd tests/e2e && pnpm exec tsc --noEmit
    # TypeScript compiles without errors
  </verify>
  <done>
    FileList and FolderTree page objects created with methods matching actual component structure. All interactions use semantic locators where possible.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ContextMenu and UploadZone page objects</name>
  <files>
    tests/e2e/page-objects/file-browser/context-menu.page.ts
    tests/e2e/page-objects/file-browser/upload-zone.page.ts
  </files>
  <action>
    First, examine ContextMenu.tsx and UploadZone.tsx components.

    1. Create tests/e2e/page-objects/file-browser/context-menu.page.ts:
       - ContextMenuPage class:
         - constructor(page: Page)
         - Locators:
           - menu(): context menu container (role="menu" or data-testid)
           - renameOption(): menuitem for Rename
           - deleteOption(): menuitem for Delete
           - downloadOption(): menuitem for Download
           - moveOption(): menuitem for Move (if exists)
         - Methods:
           - isVisible(): Promise<boolean>
           - waitForOpen(): Promise<void>
           - waitForClose(): Promise<void>
           - clickRename(): Promise<void>
           - clickDelete(): Promise<void>
           - clickDownload(): Promise<void>
           - clickMove(): Promise<void> (if move exists in context menu)
           - getVisibleOptions(): Promise<string[]>

    2. Create tests/e2e/page-objects/file-browser/upload-zone.page.ts:
       - UploadZonePage class:
         - constructor(page: Page)
         - Locators:
           - dropzone(): the drop target area
           - uploadButton(): click-to-upload button (if exists)
         - Methods:
           - uploadFile(filePath: string): Promise<void>
             - Use page.setInputFiles() on the hidden file input
           - uploadFiles(filePaths: string[]): Promise<void>
           - dragDropFile(filePath: string): Promise<void>
             - Use page.locator().dispatchEvent() for drag events
           - isDropzoneHighlighted(): Promise<boolean>
             - Check for visual feedback during drag

    Note: For file upload, Playwright supports setInputFiles() which is more reliable than simulating drag-drop. Use that as primary method, with drag-drop as secondary.

  </action>
  <verify>
    cd tests/e2e && pnpm exec tsc --noEmit
  </verify>
  <done>
    ContextMenu and UploadZone page objects created. Context menu covers all actions (rename, delete, download). Upload supports both file input and drag-drop patterns.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create dialog page objects and barrel exports</name>
  <files>
    tests/e2e/page-objects/dialogs/confirm-dialog.page.ts
    tests/e2e/page-objects/dialogs/rename-dialog.page.ts
    tests/e2e/page-objects/dialogs/index.ts
    tests/e2e/page-objects/file-browser/index.ts
    tests/e2e/page-objects/index.ts
  </files>
  <action>
    First, examine ConfirmDialog.tsx and RenameDialog.tsx components.

    1. Create tests/e2e/page-objects/dialogs/confirm-dialog.page.ts:
       - ConfirmDialogPage class:
         - constructor(page: Page)
         - Locators:
           - dialog(): role="dialog" or alertdialog
           - title(): dialog title
           - message(): dialog message/description
           - confirmButton(): primary action button
           - cancelButton(): secondary cancel button
         - Methods:
           - isVisible(): Promise<boolean>
           - waitForOpen(): Promise<void>
           - waitForClose(): Promise<void>
           - getTitle(): Promise<string>
           - getMessage(): Promise<string>
           - clickConfirm(): Promise<void>
           - clickCancel(): Promise<void>

    2. Create tests/e2e/page-objects/dialogs/rename-dialog.page.ts:
       - RenameDialogPage class:
         - constructor(page: Page)
         - Locators:
           - dialog(): rename dialog container
           - nameInput(): text input for new name
           - saveButton(): save/confirm button
           - cancelButton(): cancel button
           - errorMessage(): validation error message (if any)
         - Methods:
           - isVisible(): Promise<boolean>
           - waitForOpen(): Promise<void>
           - waitForClose(): Promise<void>
           - getCurrentName(): Promise<string>
           - enterNewName(name: string): Promise<void>
           - clearAndEnterName(name: string): Promise<void>
           - clickSave(): Promise<void>
           - clickCancel(): Promise<void>
           - getValidationError(): Promise<string | null>
           - rename(newName: string): Promise<void> - full flow: clear, type, save, wait for close

    3. Create barrel exports:

       tests/e2e/page-objects/dialogs/index.ts:
       - Export ConfirmDialogPage, RenameDialogPage

       tests/e2e/page-objects/file-browser/index.ts:
       - Export FileListPage, FolderTreePage, ContextMenuPage, UploadZonePage

       tests/e2e/page-objects/index.ts:
       - Re-export from ./file-browser
       - Re-export from ./dialogs
       - Re-export BasePage from ./base.page
       - Re-export LoginPage from ./login.page
       - Re-export DashboardPage from ./dashboard.page

    4. Update tests/e2e/fixtures/index.ts to include new page objects in fixtures if needed

  </action>
  <verify>
    cd tests/e2e && pnpm exec tsc --noEmit
    # Verify imports work:
    # Create a temporary test file that imports from page-objects/index.ts
  </verify>
  <done>
    Dialog page objects created (ConfirmDialog, RenameDialog). Barrel exports established for clean imports. All page objects can be imported from tests/e2e/page-objects.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles: cd tests/e2e && pnpm exec tsc --noEmit
2. All page objects export from barrel: import { FileListPage, ContextMenuPage, ConfirmDialogPage } from './page-objects' works
3. Page objects use semantic locators (getByRole, getByText, getByTestId) not fragile CSS selectors
4. Each page object has methods for common interactions needed by tests
</verification>

<success_criteria>

- FileListPage has methods for file/folder selection, right-click, double-click
- FolderTreePage has methods for folder navigation and expansion
- ContextMenuPage has methods for all menu actions (rename, delete, download)
- UploadZonePage supports file upload via setInputFiles
- ConfirmDialogPage handles confirm/cancel flows
- RenameDialogPage handles rename input and validation
- Clean barrel exports for all page objects
- TypeScript compilation succeeds
  </success_criteria>

<output>
After completion, create `.planning/phases/06.1-webapp-automation-testing/06.1-02-SUMMARY.md`
</output>
